<mxfile host="app.diagrams.net" modified="2025-01-19T21:00:00.000Z">
  <diagram name="Flujo Crear Base de Datos" id="create-db-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Inicio -->
        <mxCell id="start" value="Inicio" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14" vertex="1" parent="1">
          <mxGeometry x="350" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- Usuario autenticado -->
        <mxCell id="auth" value="Verificar autenticación JWT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="320" y="140" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Decisión autenticación -->
        <mxCell id="auth-check" value="¿Usuario autenticado?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="335" y="240" width="150" height="80" as="geometry" />
        </mxCell>
        
        <!-- Error auth -->
        <mxCell id="auth-error" value="Retornar 401 Unauthorized" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="580" y="250" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Fin error auth -->
        <mxCell id="end-auth-error" value="Fin" style="ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="600" y="350" width="100" height="60" as="geometry" />
        </mxCell>
        
        <!-- Validar datos -->
        <mxCell id="validate" value="Validar nombre BD y motor seleccionado" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="320" y="360" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Decisión validación -->
        <mxCell id="valid-check" value="¿Datos válidos?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="335" y="460" width="150" height="80" as="geometry" />
        </mxCell>
        
        <!-- Error validación -->
        <mxCell id="valid-error" value="Retornar 400 Bad Request" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="470" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Crear BD física -->
        <mxCell id="create-physical" value="Crear base de datos física en motor" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="320" y="580" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Crear usuario -->
        <mxCell id="create-user" value="Crear usuario único y contraseña" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="320" y="680" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Asignar permisos -->
        <mxCell id="grant-perms" value="Asignar permisos al usuario" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="320" y="780" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Encriptar contraseña -->
        <mxCell id="encrypt" value="Encriptar contraseña (AES-256)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="320" y="880" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Guardar en sistema -->
        <mxCell id="save-system" value="Registrar instancia en sistema (PostgreSQL)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="320" y="980" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Auditoría -->
        <mxCell id="audit" value="Registrar en log de auditoría" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" vertex="1" parent="1">
          <mxGeometry x="320" y="1080" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Webhook -->
        <mxCell id="notify" value="Enviar notificación Discord" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e" vertex="1" parent="1">
          <mxGeometry x="320" y="1180" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Fin exitoso -->
        <mxCell id="end-success" value="Fin - BD Creada" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14" vertex="1" parent="1">
          <mxGeometry x="350" y="1280" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- Conexiones -->
        <mxCell id="c1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="start" target="auth">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="auth" target="auth-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;exitX=1;exitY=0.5" edge="1" parent="1" source="auth-check" target="auth-error">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3-label" value="NO" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontStyle=1;fontSize=12" vertex="1" connectable="0" parent="c3">
          <mxGeometry x="-0.3" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="c4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="auth-error" target="end-auth-error">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="auth-check" target="validate">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c5-label" value="SÍ" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontStyle=1;fontSize=12" vertex="1" connectable="0" parent="c5">
          <mxGeometry x="-0.3" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="c6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="validate" target="valid-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;exitX=0;exitY=0.5" edge="1" parent="1" source="valid-check" target="valid-error">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c7-label" value="NO" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontStyle=1;fontSize=12" vertex="1" connectable="0" parent="c7">
          <mxGeometry x="-0.3" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="c8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="valid-check" target="create-physical">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c8-label" value="SÍ" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontStyle=1;fontSize=12" vertex="1" connectable="0" parent="c8">
          <mxGeometry x="-0.3" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="c9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="create-physical" target="create-user">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="create-user" target="grant-perms">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="grant-perms" target="encrypt">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="encrypt" target="save-system">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="save-system" target="audit">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="audit" target="notify">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="c15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="notify" target="end-success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
